!function(t){function e(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return t[a].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){"use strict";function i(){for(var t=[0,1,2,3,4,5,6,7,8],e=[];t.length>0;)e.push(t.splice(Math.floor(Math.random()*t.length),1)[0]);return e}var a,n,r,o,s=15,d=i(),h=!0,l=!1,p=new Phaser.Game(600,650,Phaser.CANVAS,"container");p.States={},p.States.main=function(){this.preload=function(){p.load.spritesheet("pintu","assets/img/pintu.png",184,184),p.load.image("jindu","assets/img/jindu.png"),p.load.image("jinduBg","assets/img/jinduBg.png"),p.load.image("bg","assets/img/bg.png"),"undefined"!=typeof GAME&&(this.load.baseURL=GAME+"/"),p.device.desktop||(this.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT,this.scale.forcePortrait=!0,this.scale.refresh())},this.create=function(){var t=(p.add.tileSprite(0,0,600,650,"bg"),p.add.sprite(42,24,"jinduBg"));n=p.add.sprite(10,6,"jindu"),t.addChild(n),n.width=360,p.add.tween(n).to({width:0},1e3*s,Phaser.Easing.Linear.None,!0),this.leftTime=s;var e={font:"bold 22px Microsoft Yahei",fill:"#FFF"};a=p.add.text(400,1,"还剩 "+this.leftTime+" 秒",e),t.addChild(a),p.time.events.repeat(Phaser.Timer.SECOND,s,this.refreshTime,this),o=p.add.group();var i;for(var r in d)i=o.create(25+184*Math.floor(r%3),70+184*Math.floor(r/3),"pintu",d[r]),i.sort=d[r],i.nowSort=+r,i.inputEnabled=!0,i.input.enableDrag(),i.input.enableSnap(184,184,!1,!0,25,70),i.input.bringToTop=!0,i.events.onDragStart.add(this.dragStart,this),i.events.onDragStop.add(this.dragStop,this)},this.refreshTime=function(){this.leftTime--,a.text="还剩 "+this.leftTime+" 秒",0===this.leftTime&&(alert("失败"),p.paused=!0)},this.dragStart=function(t,e){h?(h=!1,l=!0,r=$.extend(!0,{},t.position)):t.input.disableDrag()},this.dragStop=function(t,e){var i=this;if(l)if(l=!1,r.x===t.position.x&&r.y===t.position.y)h=!0,l=!1,o.setAll("input.draggable",!0);else{var a=(t.position.x-25)/184,n=(t.position.y-70)/184;if(a<0||a>2||n<0||n>2){var s=p.add.tween(t).to({x:r.x,y:r.y},300,Phaser.Easing.Quartic.Out,!0);return void s.onComplete.add(function(){h=!0,l=!1,o.setAll("input.draggable",!0)})}var d=(t.position.x-25)/184+(t.position.y-70)/184*3,u=!0;o.forEach(function(e){if(e.nowSort===d&&u===!0){u=!1,e.bringToTop();var a=p.add.tween(e).to({x:r.x,y:r.y},300,Phaser.Easing.Quartic.Out,!0);a.onComplete.add(function(){e.nowSort=t.nowSort,t.nowSort=d,u=!0,h=!0,l=!1,o.setAll("input.draggable",!0),i.checkSort()&&(alert("成功"),p.paused=!0)},this)}})}},this.checkSort=function(){var t=!0;return o.forEach(function(e){e.sort!==e.nowSort&&(t=!1)}),t}},p.state.add("main",p.States.main),p.state.start("main")}]);